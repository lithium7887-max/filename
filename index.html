<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì´ë¯¸ì§€ íŒŒì¼ ì´ë¦„ ì¼ê´„ ë³€í™˜ê¸° | SIMPLEIMG</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; background-color: #f4f7f6; margin: 0; padding: 0; line-height: 1.6; }
        .container { max-width: 800px; margin: 30px auto; padding: 25px; background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { font-size: 26px; color: #2c3e50; text-align: center; border-bottom: 2px solid #4CAF50; padding-bottom: 10px; }
        
        /* ì—…ë¡œë“œ ì˜ì—­ */
        .drop-zone {
            border: 3px dashed #4CAF50; border-radius: 15px; padding: 40px 20px;
            text-align: center; background-color: #f9fff9; color: #2e7d32;
            cursor: pointer; transition: 0.3s; margin-bottom: 20px;
        }
        .drop-zone.dragover { background-color: #e8f5e9; transform: scale(1.01); }
        input[type="file"] { display: none !important; }
        .custom-btn { background: white; border: 2px solid #4CAF50; color: #4CAF50; padding: 10px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; display: inline-block; margin: 5px; }
        .custom-btn:hover { background: #4CAF50; color: white; }

        /* ì˜µì…˜ ë° ì…ë ¥ ì˜ì—­ */
        .section { background: #fafafa; padding: 20px; border-radius: 10px; border: 1px solid #eee; margin-bottom: 20px; }
        .info-text { font-size: 13px; color: #666; margin-bottom: 10px; background: #eef7ff; padding: 10px; border-radius: 5px; border-left: 4px solid #0066cc; }
        textarea { width: 100%; height: 100px; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 14px; margin-top: 5px; }
        
        .options { display: flex; flex-direction: column; gap: 12px; margin-top: 15px; }
        .option-item { display: flex; align-items: center; font-weight: bold; cursor: pointer; }
        .option-item input { margin-right: 10px; width: 18px; height: 18px; cursor: pointer; }
        .sub-option { margin-left: 30px; font-size: 14px; color: #555; }
        input[type="number"] { width: 50px; padding: 3px; border: 1px solid #ccc; border-radius: 4px; }

        .action-btn { width: 100%; padding: 18px; background: #4CAF50; color: white; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .action-btn:hover { background: #388E3C; }
        .status { text-align: center; font-weight: bold; color: #0066cc; margin-bottom: 15px; font-size: 16px; }
    </style>
</head>
<body>

<div class="container">
    <h1>SIMPLEIMG ì´ë¦„ ì¼ê´„ ë³€í™˜ê¸° ğŸ”„</h1>

    <div id="dropZone" class="drop-zone">
        <div style="font-size: 40px;">ğŸ“¥</div>
        <b>ì‚¬ì§„ íŒŒì¼ì´ë‚˜ í´ë”ë¥¼ ì—¬ê¸°ì— ë“œë˜ê·¸í•˜ì„¸ìš”</b>
        <div style="margin-top: 15px;">
            <label for="fileInput" class="custom-btn">ğŸ“„ íŒŒì¼ ì„ íƒ</label>
            <input type="file" id="fileInput" multiple accept="image/*">
            <label for="folderInput" class="custom-btn">ğŸ“ í´ë” ì„ íƒ</label>
            <input type="file" id="folderInput" webkitdirectory directory>
        </div>
    </div>
    <div class="status" id="fileStatus">í˜„ì¬ ì„ íƒëœ ì´ë¯¸ì§€: 0ê°œ</div>

    <div class="section">
        <div class="info-text">
            ğŸ’¡ <b>ì…ë ¥ íŒ:</b> ë‹¨ì–´ë“¤ì„ <b>ì‰¼í‘œ(,)</b> ë˜ëŠ” <b>ì—”í„°(ì¤„ë°”ê¿ˆ)</b>ë¡œ êµ¬ë¶„í•´ì„œ ì…ë ¥í•´ ì£¼ì„¸ìš”. <br>
            ì˜ˆ) ì‚¬ê³¼, í¬ë„, ë°”ë‚˜ë‚˜ (í•œ ì¤„ í˜¹ì€ ì—¬ëŸ¬ ì¤„ ëª¨ë‘ ê°€ëŠ¥í•©ë‹ˆë‹¤)
        </div>
        <textarea id="nameInput" placeholder="ì´ê³³ì— ë³€ê²½í•  ë‹¨ì–´ë“¤ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
    </div>

    <div class="section">
        <div class="options">
            <label class="option-item">
                <input type="checkbox" id="optNumbering" checked>
                ğŸ”¢ ìë™ ë²ˆí˜¸ ë§¤ê¸°ê¸° (_01, _02 í˜•ì‹)
            </label>
            
            <label class="option-item">
                <input type="checkbox" id="optRandom" onchange="toggleRandom()">
                ğŸ² ë‹¨ì–´ ëœë¤ ì¡°í•© (ì…ë ¥í•œ ë‹¨ì–´ ì¤‘ ë¬´ì‘ìœ„ ì„ íƒ)
            </label>
            
            <div class="sub-option" id="randomOptionArea" style="opacity: 0.5;">
                â”” ì¡°í•©í•  ë‹¨ì–´ ê°œìˆ˜: <input type="number" id="randomCount" value="1" min="1" max="10" disabled> ê°œ
            </div>
        </div>
    </div>

    <button class="action-btn" onclick="generateZip()">ë³€í™˜ ë° ì••ì¶• ë‹¤ìš´ë¡œë“œ (.zip)</button>
</div>

<script>
    let files = [];
    const dropZone = document.getElementById('dropZone');
    const fileStatus = document.getElementById('fileStatus');

    // ëœë¤ ì˜µì…˜ í™œì„±í™”/ë¹„í™œì„±í™”
    function toggleRandom() {
        const isChecked = document.getElementById('optRandom').checked;
        const countInput = document.getElementById('randomCount');
        const area = document.getElementById('randomOptionArea');
        countInput.disabled = !isChecked;
        area.style.opacity = isChecked ? "1" : "0.5";
    }

    // íŒŒì¼ ì²˜ë¦¬ ë¡œì§ (ë“œë˜ê·¸ & ë²„íŠ¼ ê³µìš©)
    async function handleEntry(entry) {
        if (entry.isFile) {
            const file = await new Promise(res => entry.file(res));
            if (file.type.startsWith('image/')) files.push(file);
        } else if (entry.isDirectory) {
            const reader = entry.createReader();
            let entries = await new Promise(res => reader.readEntries(res));
            for (const e of entries) await handleEntry(e);
        }
    }

    dropZone.addEventListener('dragover', e => { e.preventDefault(); dropZone.classList.add('dragover'); });
    dropZone.addEventListener('dragleave', () => dropZone.classList.remove('dragover'));
    dropZone.addEventListener('drop', async e => {
        e.preventDefault();
        dropZone.classList.remove('dragover');
        const items = e.dataTransfer.items;
        for (let item of items) {
            const entry = item.webkitGetAsEntry();
            if (entry) await handleEntry(entry);
        }
        updateStatus();
    });

    document.getElementById('fileInput').addEventListener('change', e => addFiles(e.target.files));
    document.getElementById('folderInput').addEventListener('change', e => addFiles(e.target.files));

    function addFiles(newFiles) {
        for (let f of newFiles) if (f.type.startsWith('image/')) files.push(f);
        updateStatus();
    }

    function updateStatus() {
        fileStatus.innerText = `í˜„ì¬ ì„ íƒëœ ì´ë¯¸ì§€: ${files.length}ê°œ`;
    }

    // íŒŒì¼ëª… ìƒì„± ë° ì••ì¶•
    async function generateZip() {
        if (files.length === 0) return alert("ì´ë¯¸ì§€ë¥¼ ë¨¼ì € ì¶”ê°€í•´ì£¼ì„¸ìš”!");
        
        // ì‰¼í‘œì™€ ì—”í„°ë¥¼ ëª¨ë‘ êµ¬ë¶„ìë¡œ ì‚¬ìš©í•˜ì—¬ ë‹¨ì–´ ì¶”ì¶œ
        const rawInput = document.getElementById('nameInput').value;
        const words = rawInput.split(/[,\n]/).map(w => w.trim()).filter(w => w !== "");
        
        if (words.length === 0) return alert("ë³€ê²½í•  ë‹¨ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");

        const useNumbering = document.getElementById('optNumbering').checked;
        const useRandom = document.getElementById('optRandom').checked;
        const randomCount = parseInt(document.getElementById('randomCount').value) || 1;

        const zip = new JSZip();
        const btn = document.querySelector('.action-btn');
        btn.innerText = "ì‘ì—… ì¤‘... ğŸš€";
        btn.disabled = true;

        files.forEach((file, i) => {
            const ext = file.name.split('.').pop();
            let baseName = "";

            if (useRandom) {
                // ëœë¤ ì¡°í•© ëª¨ë“œ
                let picked = [];
                for(let j=0; j<randomCount; j++) {
                    picked.push(words[Math.floor(Math.random() * words.length)]);
                }
                baseName = picked.join('_');
            } else {
                // ìˆœì°¨ ëª¨ë“œ (ë‹¨ì–´ ê°œìˆ˜ë³´ë‹¤ íŒŒì¼ì´ ë§ìœ¼ë©´ ë°˜ë³µ ìˆœí™˜)
                baseName = words[i % words.length];
            }

            // ë²ˆí˜¸ ë§¤ê¸°ê¸° ì¶”ê°€
            const finalName = useNumbering ? `${baseName}_${String(i+1).padStart(2, '0')}` : baseName;
            
            // ì••ì¶• íŒŒì¼ì— ì¶”ê°€ (ë™ì¼ ì´ë¦„ ë°©ì§€ë¥¼ ìœ„í•´ ì¸ë±ìŠ¤ í™œìš©)
            zip.file(`${finalName}.${ext}`, file);
        });

        const content = await zip.generateAsync({type: "blob"});
        saveAs(content, "simpleimg_result.zip");
        
        btn.innerText = "ë³€í™˜ ë° ì••ì¶• ë‹¤ìš´ë¡œë“œ (.zip)";
        btn.disabled = false;
    }
</script>

</body>
</html>
