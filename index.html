<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì´ë¯¸ì§€ ì¼ê´„ ì´ë¦„ ë³€í™˜ê¸° (ìˆ˜ìµí™” ë²„ì „)</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-ë³¸ì¸ì•„ì´ë””" crossorigin="anonymous"></script>

    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 650px; margin: 0 auto; color: #333; }
        textarea { width: 100%; height: 120px; margin: 10px 0; padding: 10px; box-sizing: border-box; font-size: 14px; }
        button.action-btn { padding: 12px 20px; font-weight: bold; cursor: pointer; background-color: #4CAF50; color: white; border: none; border-radius: 5px; width: 100%; font-size: 16px; margin-top: 5px; }
        button.action-btn:hover { background-color: #45a049; }
        .section { background-color: #f9f9f9; padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #ddd; }
        .status { margin-top: 10px; font-weight: bold; color: #0066cc; }
        .help-text { background-color: #eef7ff; padding: 12px; border-radius: 5px; font-size: 13px; color: #0055a4; margin-bottom: 10px; border-left: 4px solid #0066cc; line-height: 1.6; }
        .options-group { margin-top: 10px; display: flex; flex-direction: column; gap: 12px; }
        label { cursor: pointer; display: flex; align-items: center; }
        input[type="number"] { padding: 4px; margin: 0 5px; border: 1px solid #ccc; border-radius: 4px; }
        input[type="number"]:disabled { background-color: #eee; cursor: not-allowed; }
        
        /* ğŸ’° ê´‘ê³  ì˜ì—­ ìŠ¤íƒ€ì¼ (ì˜¤í´ë¦­ ë°©ì§€ ë° ì˜ì—­ í™•ë³´) */
        .ad-container { 
            text-align: center; 
            margin: 20px 0; 
            min-height: 90px; 
            background-color: #f1f1f1; 
            border-radius: 5px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 13px; 
            color: #888;
            border: 2px dashed #ccc;
        }
    </style>
</head>
<body>

    <h2>ì´ë¯¸ì§€ ì¼ê´„ ì´ë¦„ ë³€í™˜ê¸° ğŸ”„</h2>

    <div class="ad-container">
        [êµ¬ê¸€ ì• ë“œì„¼ìŠ¤ ìƒë‹¨ ê´‘ê³  ì˜ì—­]
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-ë³¸ì¸ì•„ì´ë””"
             data-ad-slot="ê´‘ê³ ìŠ¬ë¡¯ë²ˆí˜¸1"
             data-ad-format="horizontal"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    
    <div class="section">
        <label><b>1. íŒŒì¼ ë˜ëŠ” í´ë” ì„ íƒ</b> (ê³„ì† ì¶”ê°€ ê°€ëŠ¥)</label><br><br>
        íŒŒì¼ ì„ íƒ: <input type="file" id="fileInput" multiple accept="image/*"><br><br>
        í´ë” ì„ íƒ: <input type="file" id="folderInput" webkitdirectory directory><br>
        
        <div class="status" id="fileCount">ì„ íƒëœ ì´ë¯¸ì§€: 0ê°œ</div>
        <button onclick="clearFiles()" style="background-color: #f44336; color:white; border:none; border-radius:4px; padding: 6px 12px; font-size: 12px; cursor:pointer; width: auto; margin-top: 10px;">ì„ íƒ ì´ˆê¸°í™”</button>
    </div>

    <div class="section">
        <label><b>2. ë³€í™˜í•  ë‹¨ì–´ ì…ë ¥ ë° ì˜µì…˜ ì„ íƒ</b></label>
        
        <div class="help-text">
            ğŸ’¡ <b>ë‹¨ì–´ ì…ë ¥ ê·œì¹™</b><br>
            â€¢ ë‹¨ì–´ì™€ ë‹¨ì–´ëŠ” <b>ì‰¼í‘œ(,)</b> ë˜ëŠ” <b>ì¤„ë°”ê¿ˆ(ì—”í„°)</b>ìœ¼ë¡œ êµ¬ë¶„í•´ ì£¼ì„¸ìš”.<br>
            â€¢ ì˜ˆì‹œ: ë¹¨ê°„, íŒŒë€, ë…¸ë€, ì‚¬ê³¼, ë°”ë‚˜ë‚˜, í¬ë„
        </div>
        
        <textarea id="nameInput" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš” (ì‰¼í‘œ ë˜ëŠ” ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„)"></textarea>

        <div class="options-group">
            <label>
                <input type="checkbox" id="optNumbering" checked>
                âœ”ï¸ <b>ìë™ ë²ˆí˜¸ ë§¤ê¸°ê¸°</b> (ì²´í¬ ì‹œ ë§¨ ë’¤ì— _01, _02 ë²ˆí˜¸ê°€ ë¶™ìŠµë‹ˆë‹¤)
            </label>
            <label>
                <input type="checkbox" id="optRandom" onchange="toggleRandomInput()">
                ğŸ² <b>ë‹¨ì–´ ëœë¤ ì ìš©</b> 
                <span style="margin-left: 10px; font-size: 14px; color: #555;">
                    (ì¡°í•©í•  ë‹¨ì–´ ê°œìˆ˜: <input type="number" id="randomCount" value="1" min="1" max="10" style="width: 50px;" disabled> ê°œ)
                </span>
            </label>
        </div>
    </div>

    <div class="ad-container" style="margin-bottom: 25px;">
        [êµ¬ê¸€ ì• ë“œì„¼ìŠ¤ í•˜ë‹¨ ê´‘ê³  ì˜ì—­]
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-ë³¸ì¸ì•„ì´ë””"
             data-ad-slot="ê´‘ê³ ìŠ¬ë¡¯ë²ˆí˜¸2"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>

    <button class="action-btn" onclick="renameAndDownload()">ë³€í™˜ ë° ì••ì¶• ë‹¤ìš´ë¡œë“œ</button>

    <script>
        let selectedFiles = [];

        const fileInput = document.getElementById('fileInput');
        const folderInput = document.getElementById('folderInput');
        const fileCountDisplay = document.getElementById('fileCount');

        function handleFiles(event) {
            const newFiles = Array.from(event.target.files);
            const imageFiles = newFiles.filter(file => file.type.startsWith('image/'));
            selectedFiles = selectedFiles.concat(imageFiles);
            fileCountDisplay.innerText = `ì„ íƒëœ ì´ë¯¸ì§€: ${selectedFiles.length}ê°œ`;
        }

        fileInput.addEventListener('change', handleFiles);
        folderInput.addEventListener('change', handleFiles);

        function clearFiles() {
            selectedFiles = [];
            fileInput.value = "";
            folderInput.value = "";
            fileCountDisplay.innerText = `ì„ íƒëœ ì´ë¯¸ì§€: 0ê°œ`;
        }

        // ëœë¤ ì²´í¬ë°•ìŠ¤ í† ê¸€
        function toggleRandomInput() {
            const isRandomChecked = document.getElementById('optRandom').checked;
            document.getElementById('randomCount').disabled = !isRandomChecked;
        }

        // ì¼ê´„ ë³€í™˜ ë° ë‹¤ìš´ë¡œë“œ
        function renameAndDownload() {
            let namesText = document.getElementById('nameInput').value;
            
            const names = namesText
                .replace(/\n/g, ',')
                .split(',')
                .map(name => name.trim())
                .filter(name => name !== '');
            
            if (selectedFiles.length === 0) {
                return alert("ì´ë¯¸ì§€ íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ í´ë”ë¥¼ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.");
            }
            if (names.length === 0) {
                return alert("ë³€ê²½í•  ë‹¨ì–´ë¥¼ í•˜ë‚˜ ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            }

            const useNumbering = document.getElementById('optNumbering').checked;
            const useRandom = document.getElementById('optRandom').checked;
            const randomCount = parseInt(document.getElementById('randomCount').value, 10) || 1;

            const zip = new JSZip();
            const digitLength = String(selectedFiles.length).length;
            const usedNamesCount = {};

            for (let i = 0; i < selectedFiles.length; i++) {
                const file = selectedFiles[i];
                const extension = file.name.substring(file.name.lastIndexOf('.'));
                
                let baseName = "";
                
                if (useRandom) {
                    let randomWordsArray = [];
                    for (let j = 0; j < randomCount; j++) {
                        const randomIndex = Math.floor(Math.random() * names.length);
                        randomWordsArray.push(names[randomIndex]);
                    }
                    baseName = randomWordsArray.join('_');
                } else {
                    if (names.length === 1) {
                        baseName = names[0];
                    } else {
                        baseName = names[i] ? names[i] : `unnamed`; 
                    }
                }
                
                if (useNumbering) {
                    const paddedIndex = String(i + 1).padStart(digitLength, '0');
                    baseName = `${baseName}_${paddedIndex}`;
                } else {
                    if (usedNamesCount[baseName]) {
                        usedNamesCount[baseName]++;
                        baseName = `${baseName}_${usedNamesCount[baseName]}`;
                    } else {
                        usedNamesCount[baseName] = 1;
                    }
                }
                
                const newFileName = baseName + extension;
                zip.file(newFileName, file);
            }
            
            zip.generateAsync({type:"blob"}).then(function(content) {
                saveAs(content, "renamed_images.zip");
            });
        }
    </script>
</body>
</html>